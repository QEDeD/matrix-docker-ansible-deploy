---
# SPDX-FileCopyrightText: 2025 MDAD project contributors
# SPDX-License-Identifier: AGPL-3.0-or-later

- name: Run docker-ansible-summary in mock mode
  ansible.builtin.include_role:
    name: docker_ansible_summary
  vars:
    docker_ansible_summary_mock_mode: true
    docker_ansible_summary_display: true
    docker_ansible_summary_write_facts: false
    docker_ansible_summary_enable_discovery: false

- name: Assert mock mode produced a table
  ansible.builtin.assert:
    that:
      - current_versions | length == 5
      - "'app-api' in current_versions"
    fail_msg: "Mock mode should seed synthetic containers without Docker"

- name: Clear mock facts for subsequent scenarios
  ansible.builtin.set_fact:
    current_versions: {}
    after_versions: {}
